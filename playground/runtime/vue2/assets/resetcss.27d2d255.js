var T=Object.defineProperty;var b=Object.getOwnPropertySymbols;var R=Object.prototype.hasOwnProperty,W=Object.prototype.propertyIsEnumerable;var v=(n,e,t)=>e in n?T(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,y=(n,e)=>{for(var t in e||(e={}))R.call(e,t)&&v(n,t,e[t]);if(b)for(var t of b(e))W.call(e,t)&&v(n,t,e[t]);return n};const $=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function t(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerpolicy&&(s.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?s.credentials="include":r.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=t(r);fetch(r.href,s)}};$();var p={exports:{}},d=typeof Reflect=="object"?Reflect:null,w=d&&typeof d.apply=="function"?d.apply:function(e,t,i){return Function.prototype.apply.call(e,t,i)},h;d&&typeof d.ownKeys=="function"?h=d.ownKeys:Object.getOwnPropertySymbols?h=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:h=function(e){return Object.getOwnPropertyNames(e)};function q(n){console&&console.warn&&console.warn(n)}var O=Number.isNaN||function(e){return e!==e};function a(){a.init.call(this)}p.exports=a;p.exports.once=H;a.EventEmitter=a;a.prototype._events=void 0;a.prototype._eventsCount=0;a.prototype._maxListeners=void 0;var L=10;function m(n){if(typeof n!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof n)}Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return L},set:function(n){if(typeof n!="number"||n<0||O(n))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+n+".");L=n}});a.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};a.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||O(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function _(n){return n._maxListeners===void 0?a.defaultMaxListeners:n._maxListeners}a.prototype.getMaxListeners=function(){return _(this)};a.prototype.emit=function(e){for(var t=[],i=1;i<arguments.length;i++)t.push(arguments[i]);var r=e==="error",s=this._events;if(s!==void 0)r=r&&s.error===void 0;else if(!r)return!1;if(r){var o;if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var c=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw c.context=o,c}var f=s[e];if(f===void 0)return!1;if(typeof f=="function")w(f,this,t);else for(var u=f.length,S=j(f,u),i=0;i<u;++i)w(S[i],this,t);return!0};function k(n,e,t,i){var r,s,o;if(m(t),s=n._events,s===void 0?(s=n._events=Object.create(null),n._eventsCount=0):(s.newListener!==void 0&&(n.emit("newListener",e,t.listener?t.listener:t),s=n._events),o=s[e]),o===void 0)o=s[e]=t,++n._eventsCount;else if(typeof o=="function"?o=s[e]=i?[t,o]:[o,t]:i?o.unshift(t):o.push(t),r=_(n),r>0&&o.length>r&&!o.warned){o.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=n,c.type=e,c.count=o.length,q(c)}return n}a.prototype.addListener=function(e,t){return k(this,e,t,!1)};a.prototype.on=a.prototype.addListener;a.prototype.prependListener=function(e,t){return k(this,e,t,!0)};function F(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function C(n,e,t){var i={fired:!1,wrapFn:void 0,target:n,type:e,listener:t},r=F.bind(i);return r.listener=t,i.wrapFn=r,r}a.prototype.once=function(e,t){return m(t),this.on(e,C(this,e,t)),this};a.prototype.prependOnceListener=function(e,t){return m(t),this.prependListener(e,C(this,e,t)),this};a.prototype.removeListener=function(e,t){var i,r,s,o,c;if(m(t),r=this._events,r===void 0)return this;if(i=r[e],i===void 0)return this;if(i===t||i.listener===t)--this._eventsCount===0?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,i.listener||t));else if(typeof i!="function"){for(s=-1,o=i.length-1;o>=0;o--)if(i[o]===t||i[o].listener===t){c=i[o].listener,s=o;break}if(s<0)return this;s===0?i.shift():D(i,s),i.length===1&&(r[e]=i[0]),r.removeListener!==void 0&&this.emit("removeListener",e,c||t)}return this};a.prototype.off=a.prototype.removeListener;a.prototype.removeAllListeners=function(e){var t,i,r;if(i=this._events,i===void 0)return this;if(i.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):i[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete i[e]),this;if(arguments.length===0){var s=Object.keys(i),o;for(r=0;r<s.length;++r)o=s[r],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(t=i[e],typeof t=="function")this.removeListener(e,t);else if(t!==void 0)for(r=t.length-1;r>=0;r--)this.removeListener(e,t[r]);return this};function N(n,e,t){var i=n._events;if(i===void 0)return[];var r=i[e];return r===void 0?[]:typeof r=="function"?t?[r.listener||r]:[r]:t?B(r):j(r,r.length)}a.prototype.listeners=function(e){return N(this,e,!0)};a.prototype.rawListeners=function(e){return N(this,e,!1)};a.listenerCount=function(n,e){return typeof n.listenerCount=="function"?n.listenerCount(e):M.call(n,e)};a.prototype.listenerCount=M;function M(n){var e=this._events;if(e!==void 0){var t=e[n];if(typeof t=="function")return 1;if(t!==void 0)return t.length}return 0}a.prototype.eventNames=function(){return this._eventsCount>0?h(this._events):[]};function j(n,e){for(var t=new Array(e),i=0;i<e;++i)t[i]=n[i];return t}function D(n,e){for(;e+1<n.length;e++)n[e]=n[e+1];n.pop()}function B(n){for(var e=new Array(n.length),t=0;t<e.length;++t)e[t]=n[t].listener||n[t];return e}function H(n,e){return new Promise(function(t,i){function r(o){n.removeListener(e,s),i(o)}function s(){typeof n.removeListener=="function"&&n.removeListener("error",r),t([].slice.call(arguments))}z(n,e,s,{once:!0}),e!=="error"&&V(n,r,{once:!0})})}function V(n,e,t){typeof n.on=="function"&&z(n,"error",e,t)}function z(n,e,t,i){if(typeof n.on=="function")i.once?n.once(e,t):n.on(e,t);else if(typeof n.addEventListener=="function")n.addEventListener(e,function r(s){i.once&&n.removeEventListener(e,r),t(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof n)}class K{constructor(e=globalThis.navigator.userAgent,t={}){this.isIos=!1,this.isIphone=!1,this.isIpad=!1,this.isAndroid=!1,this.isAnroidPad=!1,this.isMac=!1,this.isWin=!1,this.isMqq=!1,this.isWechat=!1,this.isWeb=!1,this.isIphone=e.indexOf("iPhone")>=0,this.isIpad=/(iPad).*OS\s([\d_]+)/.test(e),this.isIos=this.isIphone||this.isIpad,this.isAndroid=e.indexOf("Android")>=0,this.isAnroidPad=this.isAndroid&&e.indexOf("Mobile")<0,this.isMac=e.indexOf("Macintosh")>=0,this.isWin=e.indexOf("Windows")>=0,this.isMqq=/QQ\/([\d.]+)/.test(e),this.isWechat=e.indexOf("MicroMessenger")>=0&&e.indexOf("wxwork")<0,this.isWeb=!this.isIos&&!this.isAndroid&&!/(WebOS|BlackBerry)/.test(e),Object.entries(t).forEach(([i,r])=>{this[i]=r})}}const g="magic:common:events:",I="magic:common:actions:",l={SHOW:"show",HIDE:"hide",SCROLL_TO_VIEW:"scrollIntoView",SCROLL_TO_TOP:"scrollToTop"},U=[{label:"\u70B9\u51FB",value:`${g}click`}],A=(n,e)=>{const t=`${n}:${e}`;return n.startsWith(g)?t:`${g}${t}`},Q=n=>n.startsWith(I),P=(n,e)=>{var i;if(!n)return!1;if(!n.id)return P(n.parentElement,e);const t=(i=e.page)==null?void 0:i.getNode(n.id);return t||!1},x=(n,e,t)=>{const i=P(t.target,n);if(i){const{instance:r,data:s}=i;n.emit(A(e,s.id),r)}},X=n=>{window.document.body.addEventListener("click",e=>{x(n,"click",e)}),window.document.body.addEventListener("click",e=>{x(n,"click:capture",e)},!0)},G=(n,e)=>{const{instance:t}=e;switch(n.replace(I,"")){case l.SHOW:t.show();break;case l.HIDE:t.hide();break;case l.SCROLL_TO_VIEW:t.$el.scrollIntoView({behavior:"smooth"});break;case l.SCROLL_TO_TOP:window.scrollTo({top:0,behavior:"smooth"});break}};class E extends p.exports.EventEmitter{constructor(e){super();const{events:t}=e;this.data=e,this.events=t,this.listenLifeSafe(),this.once("destroy",()=>{this.instance=null,typeof this.data.destroy=="function"&&this.data.destroy(this),this.listenLifeSafe()})}listenLifeSafe(){this.once("created",e=>{this.instance=e,typeof this.data.created=="function"&&this.data.created(this)}),this.once("mounted",e=>{this.instance=e,typeof this.data.mounted=="function"&&this.data.mounted(this)})}}class J extends E{constructor(e){super(e.config),this.nodes=new Map,this.setNode(e.config.id,this),this.initNode(e.config)}initNode(e){var t;this.setNode(e.id,new E(e)),(t=e.items)==null||t.forEach(i=>{this.initNode(i)})}getNode(e){return this.nodes.get(e)}setNode(e,t){this.nodes.set(e,t)}deleteNode(e){this.nodes.delete(e)}}const Y=n=>{if(typeof n!="string")return n;const e={};return n.split(";").forEach(t=>{if(!t)return;const i=t.split(":");let r=i.shift(),s=i.join(":");!r||(r=r.replace(/^\s*/,"").replace(/\s*$/,""),s=s.replace(/^\s*/,"").replace(/\s*$/,""),r=r.split("-").map((o,c)=>c>0?`${o[0].toUpperCase()}${o.substr(1)}`:o).join(""),e[r]=s)}),e},Z=n=>n&&!/^url/.test(n)&&!/^linear-gradient/.test(n)?`url(${n})`:n;class te extends p.exports.EventEmitter{constructor(e){if(super(),this.pages=new Map,this.platform="mobile",this.jsEngine="browser",this.components=new Map,this.env=new K(e.ua),e.platform&&(this.platform=e.platform),e.jsEngine&&(this.jsEngine=e.jsEngine),this.platform==="mobile"||this.platform==="editor"){const t=()=>{let{width:i}=document.documentElement.getBoundingClientRect();i=Math.min(800,i);const r=i/3.75;document.documentElement.style.fontSize=`${r}px`};t(),document.body.style.fontSize="14px",globalThis.addEventListener("resize",t)}e.transformStyle&&(this.transformStyle=e.transformStyle),e.config&&this.setConfig(e.config,e.curPage),X(this)}transformStyle(e){if(!e)return{};let t={};const i={};typeof e=="string"?t=Y(e):t=y({},e);const r=["zIndex","opacity","fontWeight"];return Object.entries(t).forEach(([s,o])=>{s==="backgroundImage"?o&&(i[s]=Z(o)):s==="transform"&&typeof o!="string"?i[s]=Object.entries(o).map(([c,f])=>{let u=0;return c==="scale"&&(u=1),`${c}(${f||u})`}).join(" "):!r.includes(s)&&o&&/^[-]?[0-9]*[.]?[0-9]*$/.test(o)?i[s]=`${o/100}rem`:i[s]=o}),i}setConfig(e,t){var i,r,s;this.pages=new Map,(i=e.items)==null||i.forEach(o=>{this.pages.set(o.id,new J({config:o}))}),this.setPage(t||((s=(r=this.page)==null?void 0:r.data)==null?void 0:s.id))}setPage(e){let t;e&&(t=this.pages.get(e)),t||(t=this.pages.get(this.pages.keys().next().value)),this.page=t,this.platform!=="magic"&&this.bindEvents()}registerComponent(e,t){this.components.set(e,t)}unregisterComponent(e){this.components.delete(e)}resolveComponent(e){return this.components.get(e)}bindEvents(){var e;if(!!this.page){this.removeAllListeners();for(const[,t]of this.page.nodes)(e=t.events)==null||e.forEach(i=>{let{name:r}=i;U.findIndex(s=>s.value===r)>-1&&(r=A(r,`${t.data.id}`)),this.on(r,(s,...o)=>{var u;if(!this.page)throw new Error("\u5F53\u524D\u6CA1\u6709\u9875\u9762");const c=this.page.getNode(i.to);if(!c)throw`ID\u4E3A${i.to}\u7684\u7EC4\u4EF6\u4E0D\u5B58\u5728`;const{method:f}=i;if(Q(f))return G(f,c);typeof((u=c.instance)==null?void 0:u[f])=="function"&&c.instance[f](s,...o)})})}}destroy(){this.removeAllListeners(),this.pages.clear()}}export{te as A};
//# sourceMappingURL=resetcss.27d2d255.js.map
